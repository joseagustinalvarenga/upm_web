<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{fragments/header :: head}"></head>

<body>
    <header class="navbar navbar-dark sticky-top bg-dark flex-md-nowrap p-0 shadow">
        <a class="navbar-brand col-md-3 col-lg-2 me-0 px-3" href="#">Admin Panel</a>
    </header>

    <div class="container-fluid">
        <div class="row">
            <nav th:replace="~{fragments/admin_nav :: admin_nav}"></nav>

            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4 mt-3">
                <div
                    class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2" th:text="${courseDto.id == null ? 'Nuevo Curso' : 'Editar Curso'}">Curso</h1>
                </div>

                <form th:action="${courseDto.id == null ? '/admin/courses' : '/admin/courses/' + courseDto.id}"
                    th:object="${courseDto}" method="post" class="needs-validation" enctype="multipart/form-data">

                    <div class="mb-3">
                        <label for="title" class="form-label">Título</label>
                        <input type="text" class="form-control" th:field="*{title}" id="title" required>
                        <div class="text-danger small" th:if="${#fields.hasErrors('title')}" th:errors="*{title}">Error
                        </div>
                    </div>

                    <div class="mb-3">
                        <label for="imageFile" class="form-label">Imagen del Curso</label>
                        <input type="file" class="form-control" th:field="*{imageFile}" id="imageFile" accept="image/*">
                        <div class="form-text">Formatos permitidos: JPG, PNG, GIF.</div>
                        <div class="mt-2" th:if="${courseDto.imageUrl != null}">
                            <img th:src="${courseDto.imageUrl}" alt="Vista previa" style="max-height: 100px;">
                            <span class="text-muted small">Imagen actual</span>
                        </div>
                    </div>

                    <div class="mb-3">
                        <label for="modality" class="form-label">Modalidad</label>
                        <select class="form-select" th:field="*{modality}" id="modality">
                            <option value="PRESENCIAL">Presencial</option>
                            <option value="VIRTUAL">Virtual</option>
                            <option value="MIXTA">Mixta</option>
                        </select>
                    </div>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="duration" class="form-label">Duración</label>
                            <input type="text" class="form-control" th:field="*{duration}" id="duration"
                                placeholder="Ej: 4 años, 120 horas">
                            <div class="text-danger small" th:if="${#fields.hasErrors('duration')}"
                                th:errors="*{duration}">Error</div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="startDate" class="form-label">Fecha de Inicio</label>
                            <input type="date" class="form-control" th:field="*{startDate}" id="startDate">
                        </div>
                    </div>

                    <div class="mb-3">
                        <label for="description" class="form-label">Descripción</label>
                        <textarea class="form-control" th:field="*{description}" id="description" rows="5"
                            required></textarea>
                        <div class="text-danger small" th:if="${#fields.hasErrors('description')}"
                            th:errors="*{description}">Error</div>
                    </div>

                    <div class="mb-3">
                        <label for="status" class="form-label">Estado</label>
                        <select class="form-select" th:field="*{status}" id="status">
                            <option value="DRAFT">Borrador</option>
                            <option value="PUBLISHED">Publicado</option>
                        </select>
                    </div>

                    <hr class="my-4">
                    <button class="btn btn-primary btn-lg" type="submit">Guardar</button>
                    <a href="/admin/courses" class="btn btn-secondary btn-lg">Cancelar</a>
                </form>

            </main>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>